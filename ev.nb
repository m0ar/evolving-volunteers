(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5139,        137]
NotebookOptionsPosition[      4871,        123]
NotebookOutlinePosition[      5201,        138]
CellTagsIndexPosition[      5158,        135]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"numberOfAgents", " ", "=", " ", "10"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"donationCost", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"buyCost", " ", "=", " ", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"usageUtil", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"waitUtil", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentPayoffs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentToolNeeds", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"RandomReal", "[", "]"}]}], "]"}], ",", "numberOfAgents"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentParams", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], ",", 
         RowBox[{"RandomReal", "[", "]"}]}], "}"}]}], "]"}], ",", 
     "numberOfAgents"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentHasTool", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"False", ",", "numberOfAgents"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.690276674849732*^9, 3.690276687579483*^9}, {
   3.690276718723686*^9, 3.690276728832509*^9}, {3.690277182681115*^9, 
   3.690277194787217*^9}, {3.690277367434849*^9, 3.69027737533843*^9}, {
   3.6902775163670473`*^9, 3.690277526689817*^9}, {3.690277627149282*^9, 
   3.690277653285708*^9}, {3.690277698251495*^9, 3.690277724036525*^9}, {
   3.6902778161524973`*^9, 3.6902778596326027`*^9}, {3.690278588514905*^9, 
   3.690278590872459*^9}, {3.690278679760458*^9, 3.690278803461891*^9}, 
   3.690279290362987*^9, {3.690279863481269*^9, 3.690279864482111*^9}, {
   3.690279958729782*^9, 3.690279970924182*^9}, {3.690280196677691*^9, 
   3.690280206255906*^9}, {3.6902802426522093`*^9, 3.6902802924481907`*^9}, {
   3.6902803278094893`*^9, 3.690280329106987*^9}, {3.6902804900207157`*^9, 
   3.69028050196609*^9}, {3.690280676040114*^9, 3.690280685477113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "utility", " ", "and", " ", "if", " ", "the", 
    " ", "agent", " ", "has", " ", "a", " ", "tool"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CalculatePayoff", "[", 
      RowBox[{"p_", ",", "pb_", ",", "pd_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], "<", "pb"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"agentHasTool", ",", " ", 
           RowBox[{"{", 
            RowBox[{"usageUtil", ",", " ", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"buyCost", "-", "usageUtil"}], ",", " ", "True"}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"toolInPool", ",", " ", 
           RowBox[{"{", 
            RowBox[{"usageUtil", ",", " ", "False"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"waitUtil", ",", "False"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], "<", "pd"}], ",", 
         "\[IndentingNewLine]", "donationCost", ",", "\[IndentingNewLine]", 
         "0"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6902798722561083`*^9, 3.690279927592375*^9}, {
  3.690279985129624*^9, 3.690280054158381*^9}, {3.690280096647526*^9, 
  3.690280216858121*^9}, {3.6902802979550123`*^9, 3.690280309161378*^9}, {
  3.690280438166671*^9, 3.690280477268744*^9}, {3.690280507340279*^9, 
  3.6902805670417347`*^9}, {3.690280612273343*^9, 3.690280776811413*^9}}]
},
WindowSize->{673, 732},
WindowMargins->{{Automatic, 4}, {4, 32}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2246, 50, 241, "Input"],
Cell[2807, 72, 2060, 49, 306, "Input"]
}
]
*)

