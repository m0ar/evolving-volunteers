(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7719,        187]
NotebookOptionsPosition[      7448,        173]
NotebookOutlinePosition[      7781,        188]
CellTagsIndexPosition[      7738,        185]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"numberOfAgents", " ", "=", " ", "10"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"donationCost", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"buyCost", " ", "=", " ", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"usageUtil", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"waitUtil", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentPayoffs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentToolNeeds", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"RandomReal", "[", "]"}]}], "]"}], ",", "numberOfAgents"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentParams", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], ",", 
         RowBox[{"RandomReal", "[", "]"}]}], "}"}]}], "]"}], ",", 
     "numberOfAgents"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"agentHasTool", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"False", ",", "numberOfAgents"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.690276674849732*^9, 3.690276687579483*^9}, {
   3.690276718723686*^9, 3.690276728832509*^9}, {3.690277182681115*^9, 
   3.690277194787217*^9}, {3.690277367434849*^9, 3.69027737533843*^9}, {
   3.6902775163670473`*^9, 3.690277526689817*^9}, {3.690277627149282*^9, 
   3.690277653285708*^9}, {3.690277698251495*^9, 3.690277724036525*^9}, {
   3.6902778161524973`*^9, 3.6902778596326027`*^9}, {3.690278588514905*^9, 
   3.690278590872459*^9}, {3.690278679760458*^9, 3.690278803461891*^9}, 
   3.690279290362987*^9, {3.690279863481269*^9, 3.690279864482111*^9}, {
   3.690279958729782*^9, 3.690279970924182*^9}, {3.690280196677691*^9, 
   3.690280206255906*^9}, {3.6902802426522093`*^9, 3.6902802924481907`*^9}, {
   3.6902803278094893`*^9, 3.690280329106987*^9}, {3.6902804900207157`*^9, 
   3.69028050196609*^9}, {3.690280676040114*^9, 3.690280685477113*^9}, {
   3.690283927764642*^9, 3.6902839469161987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "utility", " ", "and", " ", "if", " ", "the", 
    " ", "agent", " ", "has", " ", "a", " ", "tool"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CalculatePayoff", "[", 
      RowBox[{"p_", ",", "pb_", ",", "pd_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], "<", "pb"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"agentHasTool", ",", " ", 
           RowBox[{"{", 
            RowBox[{"usageUtil", ",", " ", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"buyCost", "-", "usageUtil"}], ",", " ", "True"}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"toolInPool", ",", " ", 
           RowBox[{"{", 
            RowBox[{"usageUtil", ",", " ", "False"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"waitUtil", ",", "False"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], "<", "pd"}], ",", 
         "\[IndentingNewLine]", "donationCost", ",", "\[IndentingNewLine]", 
         "0"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MutateAgent", "[", "vv_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", "=", "vv"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"v", ">", "0.5"}], ",", 
          RowBox[{"distance", " ", "=", " ", 
           RowBox[{"1", "-", "v"}]}], ",", 
          RowBox[{"distance", " ", "=", "v"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"value", ":=", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"v", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"distance", "/", "4"}], ")"}], "+", "0.1"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "value", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"value", "<=", "0"}], ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"value", ",", "1"}], "]"}]}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MutateAgent", "[", "0", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6902798722561083`*^9, 3.690279927592375*^9}, {
   3.690279985129624*^9, 3.690280054158381*^9}, {3.690280096647526*^9, 
   3.690280216858121*^9}, {3.6902802979550123`*^9, 3.690280309161378*^9}, {
   3.690280438166671*^9, 3.690280477268744*^9}, {3.690280507340279*^9, 
   3.6902805670417347`*^9}, {3.690280612273343*^9, 3.690280776811413*^9}, 
   3.690281268973702*^9, {3.6902813198129396`*^9, 3.69028148938211*^9}, {
   3.690281574030089*^9, 3.690281659213862*^9}, {3.690283336743268*^9, 
   3.6902833428511744`*^9}, {3.690283391614345*^9, 3.69028341526579*^9}, {
   3.690283452287322*^9, 3.690283455847621*^9}, {3.690283960609067*^9, 
   3.690283972319025*^9}, {3.69028476973135*^9, 3.6902847911835012`*^9}, {
   3.690284913811088*^9, 3.690284943294754*^9}, {3.6902849981861687`*^9, 
   3.690285056283902*^9}, {3.69028512512528*^9, 3.690285194903532*^9}, {
   3.6902852451606407`*^9, 3.690285247465611*^9}, {3.690285288767943*^9, 
   3.690285319899272*^9}, {3.69028536663999*^9, 3.690285385558093*^9}, {
   3.6902854229369164`*^9, 3.6902854384192142`*^9}, {3.690285492376766*^9, 
   3.690285505296565*^9}, {3.690285546342104*^9, 3.690285707639079*^9}, {
   3.6902857574455223`*^9, 3.6902858591764812`*^9}, {3.690285893307517*^9, 
   3.690285943209098*^9}, {3.690286091148567*^9, 3.6902861526360893`*^9}, 
   3.690286189021058*^9, {3.690286274721895*^9, 3.6902862759068317`*^9}, {
   3.6902864556042967`*^9, 3.6902864655392*^9}, {3.690286605736759*^9, 
   3.690286607137494*^9}, {3.690286646655941*^9, 3.690286661912516*^9}}]
},
WindowSize->{1366, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2298, 51, 209, "Input"],
Cell[2859, 73, 4585, 98, 495, "Input"]
}
]
*)

